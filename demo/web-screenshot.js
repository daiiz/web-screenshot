(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var __awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(r,o){function fulfilled(t){try{step(s.next(t))}catch(t){o(t)}}function rejected(t){try{step(s.throw(t))}catch(t){o(t)}}function step(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(fulfilled,rejected)}step((s=s.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const web_screenshot_xsl_1=require("./web-screenshot-xsl"),utils_1=require("./utils");class WebScreenshot extends HTMLElement{constructor(){super(),this.render()}static get is(){return"web-screenshot"}static get observedAttributes(){return["src",...WebScreenshot.sizeAttributes]}static get sizeAttributes(){return["width","height","max-width","max-height"]}get root(){return this._root}setInitialSize(t){t.style.width="auto",t.style.height="auto";for(const e of WebScreenshot.sizeAttributes){let i=this.getAttribute(e);null!==i&&0!==i.length&&(i.endsWith("px")||(i=`${i}px`),t.style[e]=i)}}removeOlder(){this.root.innerHTML=""}attributeChangedCallback(t,e,i){return __awaiter(this,void 0,void 0,function*(){if(e!==i)switch(t){case"src":{if(!i)break;const t=utils_1.getOrigin(i);if(!utils_1.isAllowedOrigin(t,this.getAttribute("allow-origin")))throw new Error(`Origin ${t} is not allowed by attribute "allow-origin"`);const e=yield fetch(i,{mode:"cors"}),s=utils_1.parseXmlText(yield e.text()),r=utils_1.parseXmlText(web_screenshot_xsl_1.xslText);utils_1.isSlowNetwork()&&s.querySelector("external-images").remove();const o=utils_1.xslt(s,r),n=o.firstChild;if("svg"!==n.nodeName.toLowerCase())throw new Error("Unknown xml document");this.removeOlder(),this.setInitialSize(n),this.root.appendChild(o);break}case"width":case"height":case"max-width":case"max-height":{const e=this.root&&this.root.firstChild;if(!e)break;if(!i){const i="width"===t||"height"===t;e.style[t]=i?"auto":"unset";break}i.endsWith("px")||(i=`${i}px`),e.style[t]=i}}})}render(){this._root=this.attachShadow({mode:"open"})}}exports.default=WebScreenshot,window.WebScreenshot=WebScreenshot;

},{"./utils":2,"./web-screenshot-xsl":3}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseXmlText=(e=>{return(new DOMParser).parseFromString(e,"application/xml")}),exports.xslt=((e,r)=>{const t=new XSLTProcessor;return t.importStylesheet(r),t.transformToFragment(e,document)}),exports.isSlowNetwork=(()=>{const e=navigator.connection;return!!e&&("4g"!==e.effectiveType&&(console.warn("Network is slow"),!0))}),exports.getOrigin=(e=>{try{return new URL(e).origin}catch(e){throw e}}),exports.isAllowedOrigin=((e,r)=>!r||"*"===r||e===(r=r.replace(/\/$/,"")));

},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.xslText='<?xml version="1.0" encoding="utf-8"?>\n<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="web-screenshot"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><xsl:attribute name=\'width\'><xsl:value-of select="natural-width" /></xsl:attribute><xsl:attribute name=\'height\'><xsl:value-of select="natural-height" /></xsl:attribute><xsl:attribute name=\'viewBox\'><xsl:text>0</xsl:text><xsl:text> </xsl:text><xsl:text>0</xsl:text><xsl:text> </xsl:text><xsl:value-of select="natural-width" /><xsl:text> </xsl:text><xsl:value-of select="natural-height" /></xsl:attribute><defs><style type="text/css"><![CDATA[.source text {fill: #888888;font-size: 11px;font-weight: 400;text-decoration: none;font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;}.source text:hover {text-decoration: underline;fill: #2962FF;}]]></style></defs><image xmlns:xlink="http://www.w3.org/1999/xlink"><xsl:attribute name=\'x\'><xsl:text>0</xsl:text></xsl:attribute><xsl:attribute name=\'y\'><xsl:text>0</xsl:text></xsl:attribute><xsl:attribute name=\'width\'><xsl:value-of select="natural-width" /></xsl:attribute><xsl:attribute name=\'height\'><xsl:value-of select="natural-height" /></xsl:attribute><xsl:attribute name=\'xlink:href\'><xsl:value-of select="background-image/@src" /></xsl:attribute></image><a xmlns:xlink="http://www.w3.org/1999/xlink" class="source" target="_blank" style="cursor: pointer;"><xsl:attribute name=\'xlink:href\'><xsl:value-of select="cite/@source" /></xsl:attribute><text fill="transparent"><xsl:attribute name=\'x\'><xsl:value-of select="4" /></xsl:attribute><xsl:attribute name=\'y\'><xsl:value-of select="natural-height - 4" /></xsl:attribute><xsl:value-of select="cite" /></text></a><xsl:for-each select="external-images/image"><image xmlns:xlink="http://www.w3.org/1999/xlink"><xsl:attribute name=\'xlink:href\'><xsl:value-of select="@href" /></xsl:attribute><xsl:attribute name=\'x\'><xsl:value-of select="@x" /></xsl:attribute><xsl:attribute name=\'y\'><xsl:value-of select="@y" /></xsl:attribute><xsl:attribute name=\'width\'><xsl:value-of select="@width" /></xsl:attribute><xsl:attribute name=\'height\'><xsl:value-of select="@height" /></xsl:attribute></image></xsl:for-each><xsl:for-each select="external-links/link"><a xmlns:xlink="http://www.w3.org/1999/xlink" target="_blank" style="cursor: pointer;"><xsl:attribute name=\'xlink:href\'><xsl:value-of select="@href" /></xsl:attribute><rect fill="transparent"><xsl:attribute name=\'x\'><xsl:value-of select="@x" /></xsl:attribute><xsl:attribute name=\'y\'><xsl:value-of select="@y" /></xsl:attribute><xsl:attribute name=\'width\'><xsl:value-of select="@width" /></xsl:attribute><xsl:attribute name=\'height\'><xsl:value-of select="@height" /></xsl:attribute></rect><text fill="transparent"><xsl:attribute name=\'x\'><xsl:value-of select="@x" /></xsl:attribute><xsl:attribute name=\'y\'><xsl:value-of select="@y+@height" /></xsl:attribute><xsl:value-of select="." /></text></a></xsl:for-each></svg></xsl:template></xsl:stylesheet>';

},{}]},{},[1]);
